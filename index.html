// prepare the data as form body
let formBody = Object.keys(postData).map(key => 
  encodeURIComponent(key) + '=' + encodeURIComponent(postData[key])
).join('&');

// send using form-url format (NOT JSON)
fetch("https://script.google.com/macros/s/AKfycbwJ0rDWgk66C6vzJGXUK_jlq9LtIBS-Z9UtCImgEgMv_kC0CgJ5oSlkCUwMUVCooQVFaA/exec", {
  method: "POST",
  body: formBody,
  headers: {
    "Content-Type": "application/x-www-form-urlencoded"
  }
})
.then(response => {
  if (response.ok) {
    alert("Your response has been submitted to the sheet!");
  } else {
    alert("There was a problem submitting your response.");
  }
})
.catch(error => {
  console.error("Error:", error);
  alert("An error occurred while submitting.");
});
